<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="source/css/sim.css" />
    <title>Simulateur de réveil</title>
</head>

<body>

    <h1>Simulateur de reveil</h1>

    <p>
        Cette page est une simulation des fonctionnalités de mon réveil.
        <br> Attention, elle n'inclut pas toutes les fonctionnalités du réveil.
        <br> Vous pouvez uniquement tester les fonctionnalités liées aux boutons, ce réveil ne peut pas être utilisée pour la fonction du détecteur de mouvement.
        <br> Voici le guide d'utilisation:
        <ol>
            <li type="disc">truc 1</li>
            <li type="disc">truc 2</li>
            <li type="disc">truc 3...</li>
        </ol>
    </p>

    <div id="buttons">
        <button class="red" onclick="set()">set</button>
        <button class="blue" onclick="up()">up</button>
        <button class="blue" onclick="down()">down</button>
        <button class="yellow">mode</buttont>
    </div>

    <div id="reveil">
        <div id="top-box"></div>
        <div id="lcd">
            <div id='lcd-inside' class='on'>
                <a id="l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
                <br>
                <a id="l2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
            </div>
        </div>
    </div>

</body>

<script>
    mode = 0;
    alarm = ' ON';
    dodate = true;
    dotime = true;
    clockset = false;
    detectMode = 0;
    h = 12;
    m = 0;

    /*function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }*/
    function sleep(sleepDuration) {
        var now = new Date().getTime();
        while (new Date().getTime() < now + sleepDuration) { /* do nothing */ }
    }

    function add0(variable) {
        if (variable < 10) {
            return "0" + variable;
        }
        return variable;
    }

    function write(text, line) {
        l = text.length;
        //document.getElementById(line).innerHTML = text + document.getElementById(line).innerHTML.substring(text.length, document.getElementById(line).innerHTML.length)
        for (i = 0; i < (13 - l); i++) {
            text += "&nbsp;";
        }
        if (line == 'l1') {
            if (alarm) text += ' ON';
            else text += 'OFF';
        }
        if (line == 'l2') {
            if (detectMode == 1) text += 'mdt';
            else text += 'alm';
        }
        document.getElementById(line).innerHTML = text;
    }

    function setup() {
        console.log("nothing here");
    }

    /////////  MENU BUTTON CODE
    function set() {
        //console.log('set!')
        clockset = true;
        dodate = false;
        if (mode == 0) {
            write('Al: ' + add0(h) + ':' + add0(m), 'l2');
            mode = 1;
        } else if (mode == 1) {
            mode = 2;

        } else if (mode == 2) {
            mode = 0;
            dodate = true;
            clockset = false;
        }
    }

    /////////// UP BUTTON CODE
    function up() {
        if (mode == 1) {
            if (h < 23) {
                h += 1;
            } else {
                h = 0;
            }
            write('Al: ' + add0(h) + ':' + add0(m), 'l2');
        } else if (mode == 2) {
            if (m < 59) {
                m += 1;
            } else {
                m = 0;
            }
            write('Al: ' + add0(h) + ':' + add0(m), 'l2');
        } else if (mode == 0 && clockset == false) {
            if (document.getElementsByClassName("on")[0]) {
                document.getElementsByClassName("on")[0].className = "off";
            } else {
                document.getElementsByClassName("off")[0].className = "on";
            }
            console.log('light!')
        } else if (clockset == true) {
            dt.hour += 1;
        }
    }

    /////////// DOWN BUTTON CODE
    function down() {
      if (mode == 1) {
        if (h > 0) {h -= 1;
        }else {
          h = 23;        }
          write('Al: ' + add0(h) + ':' + add0(m), 'l2');
      }else if (mode == 2) {
        if (m > 0) {m -= 1;
        }else {
          m = 59;        }
          write('Al: ' + add0(h) + ':' + add0(m), 'l2');
      }else{
        if (alarm) {
           alarm = false;
            write('', 'l1');
           
           } else if (alarm == false){
           /*lcd.setCursor(0,1);
           lcd.print("           ");
           delay(300);
           lcd.setCursor(0,1);
           lcd.print("Alarm ON  ");
           lcd.setCursor(13,0);
           lcd.print(" ON");
           delay(1000);
           lcd.setCursor(0,1);
           lcd.print("           ");
           delay(300);*/
            alarm = true;
            write('', 'l1');
        }
      }
    }


    function loop() {
        var dt = new Date();
        //console.log(dodate);

        lone = add0(dt.getHours()) + ":" + add0(dt.getMinutes()) + ":" + add0(dt.getSeconds());
        ltwo = add0(dt.getDate()) + "/" + add0(dt.getMonth() + 1) + "/" + dt.getFullYear()
            /*lonel = lone.length;
            ltwol = ltwo.length;
            for (i = 0; i < (16 - lonel); i++) {
                lone += "&nbsp;";
            }
            for (i = 0; i < 16 - ltwol; i++) {
                ltwo += "&nbsp;";
            }*/


        if (dotime == true) write(lone, 'l1'); //document.getElementById("l1").innerHTML = lone;
        if (dodate == true) write(ltwo, 'l2'); //document.getElementById("l2").innerHTML = ltwo;




        //console.log("do loop things");
    }

    setup();
    setInterval(loop, 500);
</script>

</html>